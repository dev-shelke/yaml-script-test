---
- name: Ping servers and send alerts if down
  hosts: all
  gather_facts: no
  tasks:
    - name: Ping the servers
      block:
        - name: Check if server is reachable
          ping:
          register: ping_result

      rescue:
        - name: Send alert if a server is unreachable
          uri:
            url: "https://discord.com/api/webhooks/YOUR_WEBHOOK_URL"
            method: POST
            headers:
              Content-Type: "application/json"
            body: >
              {
                "content": ":x: **Server Unreachable!**\nðŸ”¹ **Hostname:** `{{ inventory_hostname }}`\nðŸ”¹ **IP:** {{ ansible_host }}"
              }
            body_format: json
            status_code: [200]
